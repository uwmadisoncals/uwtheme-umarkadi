if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=Array.prototype.forEach}(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.UWAccordion=factory()})(this,function(){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}(function(document,window){var el=document.body||document.documentElement,s=el.style,prefixAnimation="",prefixTransition="";if(s.WebkitAnimation=="")prefixAnimation="-webkit-";if(s.MozAnimation=="")prefixAnimation="-moz-";if(s.OAnimation=="")prefixAnimation="-o-";if(s.WebkitTransition=="")prefixTransition="-webkit-";if(s.MozTransition=="")prefixTransition="-moz-";if(s.OTransition=="")prefixTransition="-o-";Object.defineProperty(Object.prototype,"onCSSTransitionEnd",{value:function value(callback){var runOnce=function runOnce(e){callback();e.target.removeEventListener(e.type,runOnce)};this.addEventListener("webkitTransitionEnd",runOnce);this.addEventListener("mozTransitionEnd",runOnce);this.addEventListener("oTransitionEnd",runOnce);this.addEventListener("transitionend",runOnce);if(prefixTransition==""&&!("transition"in s)||getComputedStyle(this)[prefixTransition+"transition-duration"]=="0s")callback();return this},enumerable:false,writable:true})})(document,window,0);var UWAccordion=function(){function UWAccordion(el,options){var instance=this;_classCallCheck(this,UWAccordion);var container=typeof el==="string"?document.querySelector(el):el;if(container==null){return}var defaults={headerClass:".uw-accordion-header",panelClass:".uw-accordion-panel",panelInnerClass:".uw-accordion-panel-inner",hiddenClass:"-uw-accordion-is-hidden",activeClass:"-uw-accordion-is-active",initializedClass:"uw-accordion--initialized",headerDataAttr:"data-uw-accordion-header-id"};this.settings=_extends({},defaults,options);this.container=container;var headers=container.querySelectorAll(this.settings.headerClass);headers.forEach(function(header,index){header.classList.remove(instance.settings.headerClass.substr(1));var panelButton=document.createElement("button");var panelButtonText=header.textContent;var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");svg.setAttribute("viewBox","0 0 10 10");svg.setAttribute("focusable","false");svg.setAttribute("aria-hidden","true");var rect1=document.createElementNS("http://www.w3.org/2000/svg","rect");rect1.setAttribute("class","vert");rect1.setAttribute("width","2");rect1.setAttribute("height","8");rect1.setAttribute("y","1");rect1.setAttribute("x","4");svg.appendChild(rect1);var rect2=document.createElementNS("http://www.w3.org/2000/svg","rect");rect2.setAttribute("width","8");rect2.setAttribute("height","2");rect2.setAttribute("y","4");rect2.setAttribute("x","1");svg.appendChild(rect2);header.innerHTML="";panelButton.classList.add(instance.settings.headerClass.substr(1));panelButton.setAttribute("type","button");panelButton.setAttribute("aria-expanded","false");panelButton.appendChild(svg);panelButton.appendChild(document.createTextNode(panelButtonText));header.appendChild(panelButton)});this.headers=this.container.querySelectorAll(instance.settings.headerClass);this.panels=this.container.querySelectorAll(instance.settings.panelClass);this.panels.forEach(function(panel){panel.setAttribute("aria-hidden","true")});this.states=[].map.call(this.headers,function(){return{state:"closed"}});this.ids=[].map.call(this.headers,function(){return{id:Math.floor(Math.random()*1e6+1)}});if(this.container){this.init()}else{console.log("Something is wrong with your markup...")}}_createClass(UWAccordion,[{key:"init",value:function init(){this._setupAttributes();this.calculateAllPanelsHeight();this._insertDataAttrs();this._addListeners();this._finishInitialization()}},{key:"_insertDataAttrs",value:function _insertDataAttrs(){var instance=this;this.headers.forEach(function(header,index){header.setAttribute(instance.settings.headerDataAttr,index)})}},{key:"_finishInitialization",value:function _finishInitialization(){this.container.classList.add(this.settings.initializedClass)}},{key:"_addListeners",value:function _addListeners(){var instance=this;this.headers.forEach(function(header,index){header.addEventListener("click",function(){instance.handleClick(header,index)})})}},{key:"handleClick",value:function handleClick(targetHeader,headerIndex){this.setState(headerIndex);this._renderDom()}},{key:"setState",value:function setState(targetHeaderId){var instance=this;var states=this.getState();states.filter(function(state,index){if(index==targetHeaderId){var newState=instance.toggleState(state.state);return state.state=newState}})}},{key:"_renderDom",value:function _renderDom(){var instance=this;this.states.filter(function(state,index){if(state.state==="open"){instance.open(index)}});this.states.filter(function(state,index){if(state.state==="closed"){instance.close(index)}})}},{key:"open",value:function open(headerIndex){this.togglePanel("open",headerIndex)}},{key:"close",value:function close(headerIndex){this.togglePanel("closed",headerIndex)}},{key:"openAll",value:function openAll(){var instance=this;this.states.filter(function(state,index){return state.state="open"});this.headers.forEach(function(header,headerIndex){instance.togglePanel("open",headerIndex)})}},{key:"closeAll",value:function closeAll(){var instance=this;this.states.filter(function(state,index){return state.state="closed"});this.headers.forEach(function(header,headerIndex){instance.togglePanel("closed",headerIndex)})}},{key:"togglePanel",value:function togglePanel(action,headerIndex){if(action!==undefined&&headerIndex!==undefined){if(action==="closed"){var header=this.headers[headerIndex];var panelToClose=this.panels[headerIndex];panelToClose.classList.add(this.settings.hiddenClass);panelToClose.setAttribute("aria-hidden","true");panelToClose.classList.remove(this.settings.activeClass);header.classList.remove(this.settings.activeClass);header.setAttribute("aria-expanded",false)}else if(action==="open"){var header=this.headers[headerIndex];var panelToOpen=this.panels[headerIndex];panelToOpen.classList.remove(this.settings.hiddenClass);panelToOpen.setAttribute("aria-hidden","false");panelToOpen.classList.add(this.settings.activeClass);header.classList.add(this.settings.activeClass);header.setAttribute("aria-expanded",true)}var event=document.createEvent("Event");event.initEvent("panel-toggle",true,true);this.container.dispatchEvent(event)}}},{key:"getState",value:function getState(){return this.states}},{key:"toggleState",value:function toggleState(currentState){return currentState==="closed"?"open":"closed"}},{key:"_setupAttributes",value:function _setupAttributes(){this._setupHeaders();this._setupPanels();this._insertDataAttrs()}},{key:"calculatePanelHeight",value:function calculatePanelHeight(panel){var panelInner=panel.querySelector(this.settings.panelInnerClass);var activeHeight=panelInner.offsetHeight;activeHeight=activeHeight+28;return panel.style.maxHeight="".concat(activeHeight,"px")}},{key:"calculateAllPanelsHeight",value:function calculateAllPanelsHeight(){var instance=this;this.panels.forEach(function(panel){instance.calculatePanelHeight(panel)})}},{key:"_setupHeaders",value:function _setupHeaders(){var instance=this;this.headers.forEach(function(header,index){header.setAttribute("id","uw-accordion-header-".concat(instance.ids[index].id));header.setAttribute("aria-controls","uw-accordion-panel-".concat(instance.ids[index].id))})}},{key:"_setupPanels",value:function _setupPanels(){var instance=this;this.panels.forEach(function(panel,index){panel.setAttribute("id","uw-accordion-panel-".concat(instance.ids[index].id));panel.setAttribute("aria-labelledby","uw-accordion-header-".concat(instance.ids[index].id))})}}]);return UWAccordion}();return UWAccordion});